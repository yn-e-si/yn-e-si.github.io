---
title: "[Programmers Dev] 확률 분포 (Probability Distribution)"
excerpt: "인공지능 수학"
toc: true
toc_sticky: true
categories:
 - DL
tags:
 - 프로그래머스
 - 인공지능 수학
 - 통계학
use_math: true
---

## &#128161; 확률 분포 (Probability Distribution)

### &#128204; 확률 변수 (Random Variable)

- 랜덤한 실험 결과에 의존하는 실수이다.
  - 즉 표본 공간의 부분 집합에 대응하는 실수

<br/>

다음은 확률 변수라고 말할 수 있는 몇 가지의 예이다.

- 주사위 2개를 던지는 실험
  - 주사위 숫자의 합
  - 주사위 숫자의 차
  - 두 주사위 숫자 중 같거나 큰 수
- 동전 10개를 던지는 실험
  - 동전 앞면의 수
  - 첫 번째 앞면이 나올 때까지 던진 횟수

&#128073; 위의 예시와 같이 확률 변수는 보통 **<span style="background-color:#fffacd">표본 공간에서 실수로 대응되는 함수</span>**로 정의한다. 또한 확률변수는보통 $X$ 나 $Y$ 같은 대문자로 표시하고 항상 실수이다.

<br/>

확률변수는 다음과 같은 두 가지 종류로 구분이 된다.

- 이산확률변수 (Discrete Random Variable)
  - 확률 변수가 취할 수 있는 모든 수 값들을 하나씩 셀 수 있는 경우
  - ex) 주사위, 동전과 관련된 위에서의 예시
- 연속확률변수 (Continuous Random Variable)
  - 셀 수 없는 경우
  - ex) 어느 학교에서 랜덤하게 선택된 남학생의 키

<br/>

<br/>

### &#128204; 확률 분포 (Probability Distribution)

- 확률변수가 가질 수 있는 값에 대해 확률을 대응시켜주는 관계이다.

다음은 확률 분포에 관한 몇 가지 예이다.

- 어떤 확률 변수 $X$ 가 가질 수 있는 값이 $0,1,3,8$ 일 때, 각 값이 나올 확률
  - $P(X=0) = 0.2%$
  - $P(X=1)=0.1$
  - $P(X=3)=0.5$
  - $P(X=8)=0.2$

<br/>

- 주사위 2 개를 던지는 실험
  - 확률 변수 $X$: 주사위 숫자의 합
    - $X$ 가 가질 수 있는 값
      - $2,3, \cdots, 12$
    - 이때 $X$ 가 12가 나올 확률
      - $P(X=12)= \frac{1}{36}$
  - 확률 변수 $Y$: 주사위 숫자의 차
    - $Y$ 가 가질 수 있는 값
      - $0,1,2, \cdots, 5$
    - 이때 $Y$ 가 5가 나올 확률
      - $P(Y=5) = \frac{2}{36} =\frac{1}{18}$

<br/>

&#128073; 위의 예시와 같이 확률 분포의 정의 자체는 대응 관계를 의미하는 것이다. 또한 위의 예시에서 보면 주사위를 던질 때마다 $X$ 의 값이 달라질 수 있다. 즉 $n$ 번 실험하면, $n$ 개의 숫자가 나오는 것인데 이는 $n$ 개의 숫자의 평균과 분산을 계산할 수 있음을 의미한다.

&#128073; 따라서 확률 변수 $X$ 도 평군과 분산을 가질 수 있고 이는 모집단의 평균과 분산이라고 할 수있다.



<br/>

<br/>

#### 이산확률변수

- 이산확률변수의 확률 분포는 보통 함수로 주어진다.
- 확률변수 $X$ 가 $x$ 라는 값을 가질 확률을 의미한다.
  - $P(X=x) = f(x)$
  - 확률질량함수
- ex) 확률 변수 $X$ 가 가질 수 있는 값: $0,2,5$
  - $P(X=x)=f(x) = \frac {x+1}{10}$
    - $P(X=0) = 0.1$
    - $P(X=2)=0.3$
    - $P(X=5)=0.6$





<br/>

**이산확률변수의 평균**

- 기대값 (expected value) 라고도 한다.
- $E(X) = \sum_xxP(X=x) = \sum_x xf(x)$
- ex) $E(X) = 0 \times 0.1 + 2 \times 0.3 + 5 \times 0.6 = 3.6$

- 예를 들어 위의 실험을 100,000 번의 실험을 했다면

  - 0 이 대략적으로 10,000 번이 나온다.

  - 2 가 대략적으로 30,000 번이 나온다.

  - 5가 대략적으로 60,000 번이 나온다.

  - 따라서 평균은 다음과 같다.

    $\frac{(0 \times 10,000 + 2 \times 30,000 + 5 \times 60,000)}{100,000} = 0 \times 0.1 + 2 \times 0.3 + 5 \times 0.6 = 3.6$

> &#128173; 위의 예시를 보면 평균을 구하는 공식이 타당한 지 알 수 있다.

<br/>

**이산확률변수의 분산**

- 실험을 할 때마다 확률변수의 값이 달라질 수 있기에 그 변동의 정도인 분산을 계산할 수 있다.
- 분산은 $Var(X)$ 라고도 한다.

- $\sigma^2 = \frac{1}{N}\sum^N_{i=1} (x_i - \mu)^2$
- 분산은 또한 $(X- \mu)^2$ 의 평균이다.
- $\sigma^2 = E[(X - \mu)^2] = \sum_x(x- \mu)^2 P(X =x)$
- ex)  $\sigma^2 = (0-3.6)^2 \times 0.1 + (2-3.6)^2 \times0.3 + (5-3.6)^2 \times 0.6 = 3.24$

- 예를 들어 위의 실험을 100,000 번의 실험을 했다면

  - 평균 = 3.6

  - $(0-3.6)^2$ 이 대략적으로 10,000 번 나온다.

  - $(2-3.6)^2$ 이 대략적으로 30,000 번 나온다.

  - $(5-3.6)^2$ 이 대략적으로 60,000 번 나온다.

  - 따라서 분산은 다음과 같다.

    $\sigma^2 = \frac{((0-3.6)^2 \times 10,000 + (2-3.6)^2 \times 30,000 + (5-3.6)^2 \times 60,000)}{100,000} = 3.24$

> &#128173; 위의 예시를 보면 평균을 구하는 공식이 타당한 지 알 수 있다.

<br/>

**이산확률 변수 $X$의 분산: 간편식**

위의 분산 구하는 공식을 보다 간편하게 정리를 하면 다음과 같이 정의된다.

<br/>
$$
\sigma^2 = \sum_x (x-\mu)^2P(X=x) = \sum_x(x^2 -2\mu x + \mu^2)P(X=x) 
$$
<br/><br/>
$$
=\sum_xx^2P(X=x) - \sum_x2\mu xP(X=x) + \sum_x\mu^2P(X=x) 
$$
<br/><br/>
$$
= E(X^2) - 2\mu \sum_xxP(X=x) + \mu^2\sum_xP(X=x) 
$$
<br/><br/>
$$
= E(X^2) - 2\mu^2 +\mu^2 = E(X^2) - \mu^2 = E(X^2) - \{E(X)\}^2
$$
<br/>

<br/>

**이산확률변수의 표준편차**

- 분산의 양의 제곱근이다.
- $SD(X)$ 라고도 한다.
- $\sqrt{\sigma^2} = \sigma$

<br/>

#### 결합확률분포 (Joint Probability Distribution)

- 두 개 이상의 확률변수가 동시에 취하는 값들에 대해 확률을 대응시켜주는 관계이다.
- 결합확률분포를 통해 각 확률변수의 확률분포를 도출할 수 있는데, 이를 주변확률분포 (marginal probability distribution) 라 한다.

<br/>

#### 공분산 (Covariance)

- 2 개의 확률변수의 선형 관계를 나타내는 값이다.
- 만약 2 개의 변수중 하나의 값이 상승하는 경향을 보일 때 다른 값도 상승하는 선형 상관성이 있다면 양수의 공분산을 감소하는 상관성이 있다면 음수의 공분산을 관계가 없다면 0에 가까운 값을 가진다.

<br/>
$$
Cov(X,Y) = E[(X-\mu_X)(Y-\mu_Y)] = E[XY-\mu_XY-\mu_YX +\mu_X\mu_Y]
$$
<br/><br/>
$$
=E[XY]+E[-\mu_XY]+E[-\mu_YX]+E[\mu_X\mu_Y]
$$
<br/><br/>
$$
=E[XY]-\mu_X E[Y] - \mu_YE[X] + \mu_X\mu_Y 
$$
<br/><br/>
$$
= E[XY]-\mu_X\mu_Y -\mu_Y\mu_X+ \mu_X\mu_Y= E[XY] - E[X]E[Y]
$$
<br/><br/>

#### 상관계수 (Correlation Coefficient)

- 공분산은 각 확률변수의 절대적인 크기에 영향을 받는다.

> &#128173; 이는 확률변수의 단위에 영향을 받는 다는 것이다.

- 따라서 단위에 의한 영향을 없앨 필요가 있고 상관계수는 두 확률변수의 단위에 영향없는 상관관계의 수치를 알려준다.

- $\rho = Corr(X,Y) = \frac{Cov(X,Y)}{\sigma_X\sigma_Y}$



<br/>

<br/>

<br/>

다음으로 실제 생활에서 발생하는 많은 현상들을 잘 표현하는 4 가지의 확률분포에 대해 정리했다.

어느 경우에 어떤 분포를 사용할지를 잘 판단해서 적절하게 사용하면 된다!

<br/><br/>

### &#128204; 이항분포 (Binomial Distribution)

- 베르누이 시행 (Bernoulli trial)
  - 실험 중에서 정확하게 **2 개의 결과만을 가지는 실험**을 말한다.
    - ex) 동전 던지기
  - 보통 성공과 실패로 결과를 구분한다.
  - 성공의 확률: $P$
  - 실패의 확률: $1-P$
- 확률변수 $X$
  - $n$ **번의 베르누이 시행**에서 성공의 횟수이다.
  - 이항확률변수라고도 한다

&#128073; 이항분포는 이항확률변수의 확률분포이다.

<br/>

- 이항확률변수 $X$의 확률분포
  - $f(x) = P[X=x]  =  {n \choose x}P^x(1-p)^{n-x}$

- 평균
  - $E(X) = np$
- 분산
  - $Var(X) = np(1-p)$
- 표준편차
  - $\sqrt{(np(1-p)}$

<br/>

예) 어떤 랜덤박스의 뽑기 성공 확률이 0.2 이다. 3개를 뽑았을 때, 적어도 하나 이상의 성공이 발생할 확률은?

<br/>
$$
P[X \geq 1] = 1-P[X=0]=1- {3 \choose0}(0.2)^0(1-0.2)^{3-0} = 1 - 0.512 = 0.488
$$
<br/>

**python code**

```python
from scipy import stats
# cdf 는 주어진 x 값보다 같거나 작은 확률을 구해준다.
# 따라서 1 - (0보다 같거나 작은 확률) 과 같다.
1 - stats.binom.cdf(0, n=3, p=0.2)

# (평균, 분산) 을 리턴해준다.
stats.binom.stats(n=3, p=0.2)
> (array(0.6), array(0.48))
```



<br/>

<br/>

### &#128204; 정규분포 (Normal Distribution)

- 연속확률변수의 확률분포이다.

  - 확률밀도함수 (Probability Density Function)
    - $f(x)$
  - $P[ a \leq X \leq b] = \int_a^bf(x)dx$
  - 그래프의 해당 구간 $(a,b)$ 에 대한 넓이가 확률이다.

  - 또한 $f(x)$ 값이 크면 클수록 해당 $x$ 에 값들이 몰려있다는 의미가 있다.

- 한 점에서의 확률은 연속확률변수에서는 항상 0과 같다.

> &#128173; $ a \leq x \leq a $ 에서 해당 구간을 적분할 경우 값은 0이다.

<br/>

- 정규분포의 확률밀도함수
  - $f(x) = \frac{1}{\sqrt{2 \pi }\sigma}e ^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}$
  - $\mu = 0, \sigma=1$
  - $X \sim N(\mu,\sigma^2)$: 확률변수 $X$ 는 평균이 $\mu$ 이고 분산이 $\sigma^2$ 인 정규분포를 따른다 라는 의미이다.

<br/>

- 표준정규확률변수 (Standard Normal Random Variable)
  - $Z = \frac{X-\mu}{\sigma}$

> &#128173; $x$ 가 정규분포를 따르는 정규확률변수인 경우 사용이 가능하다.

<br/>

- 표준정규분포 (Standard Normal Distribution)
  - $Z \sim N(0,1)$ : 표준정규확률변수 $z$ 는 평균이 $0$ 이고, 분산이 $1$ 인 정규확률분포를 따른다.
  - 표준정규분포표를 통해 확률계산이 가능하다.
    - $P[Z \leq z]$
  - 정규분포를 따르는 모든 정규확률변수는 표준정규확률변수로 변환이 가능하기 때문에 이를 통해 확률을 계산할 수 있다.

예)

- $X \sim N(4,3^2)$
  - $P[X \leq 4] = ?$

<br/>
$$
= P\left[\frac{X-\mu}{\sigma} \leq \frac{4-\mu}{\sigma}\right] = P\left[Z \leq \frac{4 -4}{3}\right] = P[Z \leq 0 ] = 0.5
$$
<br/>

**python code**

```python
# loc: 평균, scale: 표준편차
stats.norm.cdf(4, loc = 4, scale = 3)
> 0.5
```

<br/>

- $X \sim N(4, 3^2)$
  - $P[4 \leq X \leq 7] = ?$

<br/>
$$
= P[X \leq7] - P[X<4]=  P\left[Z \leq \frac{7 -4}{3}\right]-P[Z<0] = P[Z \leq 1 ] - P[Z<0] 
$$
<br/>
$$
= 0.8413 - 0.5 = 0.3413
$$
<br/>

**python code**

```python
stats.norm.cdf(7, loc = 4, scale = 3) - stats.norm.cdf(4, loc = 4, sclae = 3)
> 0.3413447460685429
```

<br/>

<br/>

### &#128204; 포아송 분포 (Poisson Distribution)

- 일정한 시간단위 또는 공간 단위에서 발생하는 이벤트 수의 확률분포
  - 하루 동안 어떤 웹사이트를 방문하는 방문자의 수
  - 어떤 미용실에 한 시간동안 방문하는 손님의 수
  - 어떤 전기선 100 미터당 발생하는 결함의 수

<br/>

- 확률분포함수 (확률질량함수)
  - $P[X=x]=f(x)=\lambda^x\frac{e^{-\lambda}}{x!}, x=0,1,2,\cdots$
  - 평균
    - $\lambda$
  - 분산
    -  $\lambda$

> &#128173; 파라미터가 $\lambda$ 하나만 있기에 $\lambda$ 만 정해지면, 평균과 분산이 모두 결정되는 특징이 있다.

<br/>

예) 어느 웹사이트에 시간당 접속자 수는 평균이 $3 (\lambda=3)$ 인 포아송 분포를 따른다고한다.

앞으로 1시간 동안 접속자 수가 2명 이하일 확률은?

> &#128173; 일정 기간 동안 상대도수를 계산해서 대체로 포아송분포에 들어맞더라 하는 계산을 해서 이 확률분포를 따르는지 확인 해야 포아송 분포를 사용할 수 있다. 실제 이런 종류의 문제를 만났을 때 시간이 없다면 대체로 포아송분포를 가정하는 것이 잘 들어맞을 확률이 높다!

<br/>

 $P[X \leq 2] = ?$ 

<br/>
$$
P[X \leq 2 ] = P[X = 0] + P[X=1]+P[X=2] 
$$
<br/>
$$
= 3^0\frac{e^{-3}}{0!} +  3^1\frac{e^{-3}}{1!} +  3^2\frac{e^{-3}}{2!} = 0.04998 + 0.14936+0.22404 = 0.42319
$$
<br/>

**python code**

```python
stats.poisson.cdf(2, mu=3)
> 0.42319008112684364
```

<br/>

<br/>

### &#128204; 지수분포 (Exponential Distribution)

- 포아송 분포에 의해 어떤 사건이 발생할 때, 어느 한 시점으로부터 이 사건이 발생할 때까지 **걸리는 시간**에 대한 확률분포이다.

- 확률밀도함수
  - $f(t) = \lambda e^{-\lambda t}$
  - $\lambda$: 포아송분포의 평균
  - 평균
    - $E(T) = \frac{1}{\lambda}$
  - 분산
    - $Var(T) = \frac{1}{\lambda^2}$

<br/>

예) 어느 웹사이트에 시간당 접속자 수는 $ \lambda = 3$ 인 포아송 분포를 따른다고 한다.

지금부터 시작하여 첫 번째 접속자가 30 분 이내에 올 확률은?

> &#128173; $T$ 가 시간당이기에 30 분은 0.5 와 같다.
>
> &#128173; 단위가 시간이기에 가장 작은 시간은 0 이다.

<br/>

$P[T \leq 0.5] = ?$

<br/>
$$
P[T \leq 0.5] = \int^{0.5}_0 \lambda e^{-\lambda t}dt = \int_0^{0.5}3e^{-3t}dt = [-e^{-3t}]^{0.5}_0 = 1-e^{-1.5}
$$
<br/>
$$
=1-0.2231=0.7769 
$$
<br/>

**python code**

```python
lam=3
stats.expon.cdf(0.5, scale = 1/lam) # scale: 표준편차
> 0.7768698398515702
```



<br/>

<br/>

## &#128161; Check Point

- 확률변수와 확률분포의 정의를 잘 기억해 두기!
- 위에 정리한 4 개의 분포 말고도 다양한 확률분포들이 존재한다. 따라서 실제문제에 맞게 필요한 확률분포를 명확하게 판단해서 사용해야 한다!! 