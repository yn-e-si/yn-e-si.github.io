---
title: "[Programmers Dev] 추정과 검정"
excerpt: "인공지능 수학"
toc: true
toc_sticky: true
categories:
 - DL
tags:
 - 프로그래머스
 - 인공지능 수학
 - 통계학
use_math: true
---

## &#128161; 추정과 검정

### &#128204; 추정

#### 모평균의 추정

점추정

- 점 추정치는 모수의 가장 비슷한 단일 값이다.

- 표본평균이 모평균의 점 추정값 (추정량)이 된다.

> &#128173; 모평균의 점 추정값은 표본평균 그 자체다. 하지만 점추정만 가지고는 이 값이 어떤 의미를 가지는지 근거가 확실하지 않기에 명확한 설명을 하기가 곤란하다. 따라서 확률적인 근거를 제시해줄 필요가 있기에 점추정보다 구간추정을 자주 사용한다.



<br/>
구간추정

- 모평균 $\mu$ 의 $100(1- \alpha)%$ 신뢰구간 (Confidence Interval)
  - ($\mu$ 의 추정량)  $\pm z_{\alpha/2} $ (추정량의 표준편차)
- 신뢰 구간은 모집단 모수를 포함할 가능성이 있는 값의 범위이다.
- 정규분포에서 $\sigma$ 를 알 때,
  - $\left( \bar x - z_{\alpha / 2} \frac {\sigma}{\sqrt n }, \bar x + z_{\alpha /2 } \frac {\sigma}{\sqrt n } \right )$

> &#128173; 문제에 따라서 $\alpha$ 를 정해야하고 표본평균을 이용해서 구간을 제시해 준다. 

&#128073; 위의 수식은 정규분포가 아니거나 표준편차가 알려져 있지 않을 경우 구할 수 없기에 실용적이지가 않다. 따라서 일반적으로 위의 수식으로 신뢰구간을 구하진 않고 아래의 수식을 주로 사용한다.

<br/>

- 표본의 크기가 클 때 중심극한정리 사용
  - ($\mu$ 의 추정량) $\pm z_{\alpha/2}$ (추정량의 표준편차)
  - $s$: 표본표준편차

> &#128173; 중심극한정리를 따를 때, 위와 같은 공식을 이용할 수 있는데 보통 모집단이 정규분포를 따른다는 것이 확인하기 어렵기에 중심극한정리가 중요하게 여겨지는 것이다.

<br/>

예) 구간추정

어떤 학교의 고1 남학생의 평균키를 추정하기 위해 36 명을 표본으로 추출하여 그 표본평균과 표본표준편차를 계산하여 그 결과가 아래와 같다.

<br/>

$\bar x = 173.6, s = 3.6$

<br/>

이 때, 평균키에 대한 $95 \%$ 신뢰 구간을 구하시오.

- 표본이 ($n \geq 30$) 이므로 중심극한정리에 의해 정규분포를 따른다.
- $\alpha = 0.05$
- $z_{\alpha/2} = z_{0.025} = 1.96$

- $z_{\alpha/2}\frac{s}{\sqrt{n}} = 1.96 \times \frac{3.6}{\sqrt{36}} = 1.96 \times \frac {3.6}{6} = 1.176$
- $95\%$ 신뢰구간
  - $ (173.6 - 1.176, 173.6 + 1.176) = (172.4, 174.8)$

<br/>

<br/>

예) 구간추정

어떤 농장에서 생산된 계란 30 개의 표본을 뽑았더니 그 무게가 아래와 같다.

- w = [10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2]

- 계란의 평균 무게에 대한 $ 95 \%$ 신뢰 구간을 구하시오.

- $\alpha = 0.05$
- $z_{\alpha/2} = z_{0.025} = 1.96$''

- $\bar X = 10.43$
- $s = 1.11$
- $z_{\alpha/2}\frac{s}{\sqrt n } = 1.96 \times \frac{1.11}{\sqrt{30}} = 0.397$
- $95 \%$ 신뢰구간
  - $(10.43 - 0.397, 10.43 + 0.397) = (10.033, 10.827)$

```python
import numpy as np
import scipy.stats

w =  [10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 
      11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 
      8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2]

xbar = np.mean(w)

# 표본표준편차 이기에 n-1
sd = np.std(w, ddof = 1) 

print("평균 %.2f, 표준편차: %.2f" %(xbar, sd))

alpha = 0.05

# 97.5 % 에 해당하는 z alpha 값을 구해주는 함수
zalpha = scipy.stats.norm.ppf(1-aplha/2) 

print("zaplha: ", zalpha)
```

<br/>

<br/>

#### 모비율의 추정

점추정

- 확률변수 $X$
  - $n$ 개의 표본에서 특정 속성을 갖는 표본의 개수

- 모비율 $p$ 의 점추정량
  - $\hat p = \frac {X}{n}$

> &#128173; 표본을 뽑을 때마다 추정량 값이 달라지기에 통계적 근거로 쓰이기엔 부족한 부분이 있다. 그래서 점추정 보단 구간추정이 더 많이 쓰이게 된다.

<br/>

예) 점추정

대학교 1학년생의 흡연율을 조사하기 위해 150 명을 랜덤하게 선택하여 흡연여부를 조사하였다. 이 중 48 명이 흡연을 하고 있었다. 이 때, 이 대학교 1학년생의 흡연율의 평균을 점추정하시오.

- $n = 150, X = 48$
- $\hat p = \frac {X}{n} = \frac{48}{150} = 0.32$
- 평균흡연율은 $32\%$ 로 추정된다.

<br/>

구간추정

- $n$ 이 충분히 클 때,
  - $n \hat p > 5, n(1- \hat p) > 5$ 일 때를 의미한다.
  - $X \sim N (np, np(1-p))$ 

<br/>

- 확률변수 $X$ 의 표준화
  - $Z = \frac{X-np}{\sqrt{n\hat p (1- \hat p)}} = \frac { \hat p - p } {\sqrt{ \frac{\hat p(1-\hat p )}{n}}}$
  - 근사적으로 표준정규분포 $N(0,1)$ 를 따른다.

<br/>

- $P(\vert Z\vert \leq z_{\alpha/2}) = 1 - \alpha$
  - $P( - z_{\alpha/2} \leq Z \leq z_{\alpha/2}) = P \left(-z_{\alpha/2} \leq  \frac {\hat p - p}{\sqrt{ \frac {\hat p (1-\hat p )}{n}}} \leq z_{\alpha/2} \right)$
  - $P \left( \hat p - z_{\frac{\alpha}{2}} \sqrt { \frac {\hat p (1- \hat p )}{n}} \leq p \leq \hat p + z_{ \frac{\alpha}{2}} \sqrt{\frac{\hat p (1-\hat p ) } {n}} \right) = 1 - \alpha$

<br/>

- 모비율 $p$ 의 $100(1-\alpha)\%$ 신뢰구간 (confidence interval)
  - $\left( \hat p - z_{\frac{\alpha}{2}} \sqrt { \frac {\hat p (1- \hat p )}{n}} , \hat p + z_{ \frac{\alpha}{2}} \sqrt{\frac{\hat p (1-\hat p ) } {n}} \right) $

<br/>

예) 구간추정

대학교 1학년생의 흡연율을 조사하기 위해 150 명을 랜덤하게 선택하여 흡연여뷰를 조사하였다. 이 중 48 명이 흡연을 하고 있었다. 이 때, 흡연율 $p$ 의 $95\%$ 신뢰구간을 구하시오.

- $\alpha = 0.05, z_{\frac{\alpha}{2}} = z_{0.025} = 1.96, \hat p = 0.32$

- $\sqrt {  \frac{ \hat p (1- \hat p ) } {n} } = \sqrt \frac { (0.32)(0.68) } { 150} = 0.038$

- $(0.32 - 1.96 \times 0.038, 0.32 + 1.96 \times 0.038) = (0.245, 0.395)$

```python
import numpy as np

x = 48
n = 150
phat = x / n
alpha = 0.05
zaplha = scipy.stats.norm.ppf(1- alpha/2)
sd = np.sqrt(phat * (1-phat) / n )

print("phat %.3f, zaplha: %.3f, sd: %.3f"%(phat, zaplha, sd))

ci = [phat - zalpha * sd, phat + zalpha * sd]
print(ci)
```

<br/>

<br/>

### &#128204; 검정

예)

어떤 고등학교의 1학년 학생들의 평균키가 170.5 cm 로 알려져 있다. 올해 새로 들어온 1학년 학생들 중 30 명을 랜덤하게 선택하여 키를 잰 후 평균을 계산했더니 171.3 cm 였다. 이 때, 올해 신입생은 평균키가 170.5 cm 보다 더 크다고 할 수 있는가?

-  이러한 주장을 검증하는 것이 가설 검정이다.
- 표본평균 $\bar X $ 가 $\mu_0$ 보다 얼마나 커야 모평균 $\mu$ 가 $\mu_0$ 보다 크다고 할 수 있을 까?
  - 표본평균은 표본의 선택에 의해 달라짐에 주의해야한다.

위와 같은 주장을 검증할 때 사용하는 것이 가설검정이다. 이는 다음과 같다.

<br/>

가설검정

- 귀무가설 $H_0 : \mu = \mu_0$
- 대립가설 $H_1 : \mu > \mu_0$
- 귀무가설을 기각하기 위해서는 $\bar X $ 가 좀 큰 값이 나와야 한다.
  - 귀무가설이 참이라는 가정하에, 랜덤하게 선택한 표본에서 지금의 $\bar X $ 가 나올 확률을 계산할 필요가 있다.
  - 이 때, 이 확률이 낮다면 귀무가설이 참이 아니라고 판단한다.

> &#128173; 귀무가설이 참이라는 가정하에, 표본을 뽑아서 무엇인가를 계산했을 때 그 값이 나올 확률이 얼마나 되느냐, 그 값이 아주 낮다면 랜덤하게 나올 수 있는 확률을 넘어선다. 따라서 귀무가설을 기각한다 라는 결과가 나오게 되는 것이다.

- 확률이 낮다는 기준점이 필요
  - 유의수준 $\alpha$ 도입
- $P( \bar X \geq k ) \leq \alpha$ 가 되는 $k$ 를 찾아야 한다.

- 표준정규확률변수로 변환 $\rightarrow$ 검정통계량

> &#128173; 검정통계량은 가설 검정에서 사용된 샘플 데이터로부터 계산된 랜덤변수이다. 즉 검정을 위해 우리가 추출한 표본을 통해서 계산한 특성값이다. 모평균에 대해 검정할 경우, 표본평균을 계산하고 z score 로 바꾸게 되면 이것이 검정통계량이 되는 것이다. 검정통계량은 검정하려는 것에 따라 달라지게 된다.

- $Z = \frac { \bar X - \mu } {S / \sqrt n} \sim N(0,1)$
- $P(Z \geq z_\alpha) = \alpha$



따라서 $\bar X $ 를 $Z$ 로 변환한 후 $Z$ 값이 $z_\alpha$ 보다 큰지를 검토해야한다.

- 크다면 귀무가설 기각
- 그렇지 않다면 귀무가설 채택

<br/>



검정의 단계

- $H_0, H_1 $ 설정
- 유의수준 $\alpha$ 설정
- 검정통계량 계산
- 기각역 또는 임계값 계산
- 주어진 데이터로부터 유의성 판정

> &#128173; ''이러한 주장이 일어날 수 있는 상황이다" 라는 것은 귀무가설을 참이라고 가정했을 때, 랜덤하게 선택할 경우 이러한 검정통계량이 나올 수 있다라는 것이다.

<br/>

#### 모평균의 검정

- 대립가설
  - 문제에서 검정하고자 하는 것이 무엇인지 파악할 필요가 있다.
    - 대립가설 $H_1$ 채택을 위한 통계적 증거 확보 필요
    - 증거가 없으면 귀무가설 $H_0$ 채택
    - $H_1: \mu > \mu_0$
    - $H_1: \mu < \mu_0$
    - $H_1: \mu \neq \mu_0$

> &#128173; 즉 대립가설은 새롭게 주장하고자 하는 가설을 말한다.

<br/>

예)

어떤 농장에서 생산되는 계란의 평균 무게는 10.5 그램으로 알려져 있다. 새로운 사료를 도입한 후에 생산된 계란 30 개의 표본평균을 계산했더니 11.4 그램이 나왔다. 새로운 사료가 평균적으로 더 무거운 계란을 생산한다고 할 수 있는가?

- $H_0 : \mu = 10.5$
- $H_0 : \mu > 10.5$



<br/>

예)

어떤 농장에서 생산되는 계란의 평균 무게는 10.5 그램으로 알려져 있다. 새로운 사료를 도입한 후에 생산된 계란 30 개의 표본평균을 계산했더니 9.4 그램이 나왔다. 새로운 사료가 평균적으로 더 가벼운 계란을 생산한다고 할 수 있는가?

- $H_0: \mu = 10.5$
- $H_1: \mu < 10.5$

<br/>

예)

어떤 농장에서 자신들이 생산하는 계란의 평균 무게가 10.5 그램이라고 홍보하고 있다. 이에 생산된 계란 30 개의 표본평균을 계산했더니 9.4 그램이 나왔다. 이 농장의 광고가 맞다고 할 수 있나?

- $H_0 : \mu = 10.5$
- $H_1: \mu \neq 10.5$



<br/>

검정통계량

- $n \geq30$ 인 경우
  - 중심극한정리 사용
  - $Z = \frac {\bar X - \mu}{s /\sqrt n } \sim N(0,1)$

- 모집단이 정규모집단이고, 모표준편차 $\sigma$ 가 주어진 경우
  - $Z = \frac {\bar X - \mu}{\sigma /\sqrt n } \sim N(0,1)$

<br/>

기각역

- $H_0: \mu = 10.5$
- 유의수준: $\alpha$
- 기각역
  - $H_1: \mu > 10.5 \rightarrow Z > z_\alpha$
  - $H_1: \mu < 10.5 \rightarrow Z < -z_\alpha$
  - $H_1: \mu \neq 10.5 \rightarrow \vert Z \vert > z_{ \frac {\alpha}{2}}$



<br/>

예)

어떤 농장에서 자신들이 생산하는 계란의 평균 무게가 10.5 그램이라고 홍보하고 있다. 이에 생산된 계란 30 개의 표본을 뽑았더니 그 무게가 아래와 같다.

- w= [10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2]
- 이 농장의 홍보가 맞는지 유의수준 $5 \%$ 로 검정하시오.

<br/>

<br/>

- $H_0: \mu = 10.5$
- $H_1: \mu \neq 10.5$
- $\alpha = 0.05$
- $\bar x = 10.43$
- $ s = 1.11$
- $Z = \frac {\bar X - \mu}{s / \sqrt n } = \frac{10.43 - 10.5}{1.11 / \sqrt {30}} = -0.351$
- $z_{ \frac {\alpha} {2} } = z_{0.025} = 1.96 > \vert -0.351 \vert = \vert Z \vert$
- 따라서 귀무가설을 기각할 수 없다.

```python
import numpy as np
import scipy.stats

w = [10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 
     11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 
     8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2]

mu = 10.5
xbar = np.mean(w)
sd = np.std(w, ddof=1)
print("평균 %.2f, 표준편차: %.2f"%(xbar, sd))

z = (xbar - mu) / (sd/np.sqrt(len(w)))
print("검정통계량:", z)

alpha = 0.05
cri = scipy.stats.norm.ppf(1-alpha/2)
print("임계값: ", cri)
```



<br/>

<br/>

## &#128161; Check Point

- 점추정은 통계적 근거가 되기엔 부족한 면이 많기에 보통 **구간추정**을 많이쓴다.
- 검정통계량은 검정하려는 것에 따라 달라지게 되고 대립가설에 따라 검정에 결과가 달라지기에 무엇보다 **대립가설**을 잘 파악하는 것이 중요하다!